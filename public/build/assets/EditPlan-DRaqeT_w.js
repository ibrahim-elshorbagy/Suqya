import{r as h,j as e,u as F,H as E,L as j}from"./app-DSIbhGoO.js";import{A as I}from"./AppLayout-D7k058Rw.js";import{u as S}from"./useTrans-Dl6FgQZB.js";import{I as C,a as A}from"./InputLabel-BOKI3cXF.js";import{T as y}from"./TextInput-BcJrrnoZ.js";import{P as R}from"./PrimaryButton-DfXPtYXW.js";import{S as W}from"./SecondaryButton-DmPIQpNz.js";import"./ApplicationLogo-DApQUQZ1.js";import"./Toastify-CHFw-kGA.js";import"./index-6vMygO0b.js";import"./Footer-BvOCRTNr.js";h.forwardRef(function({className:x="",...s},c){const o=h.useRef(null);return h.useImperativeHandle(c,()=>({focus:()=>o.current?.focus()})),e.jsx("input",{...s,type:"checkbox",className:"h-4 w-4 rounded border-2 border-neutral-300 dark:border-neutral-600 bg-neutral-50 dark:bg-neutral-800 text-blue-600 focus:ring-2 focus:ring-blue-200 dark:focus:ring-blue-900 focus:border-blue-500 dark:focus:border-blue-400 transition-all cursor-pointer"+(s.disabled?" opacity-60 cursor-not-allowed bg-neutral-200 dark:bg-neutral-700":"")+(x?` ${x}`:""),ref:o})});function J({plan:d,features:x}){const{t:s}=S(),{data:c,setData:o,put:b,errors:g,processing:v}=F({price:d.price||"",features:d.features?.map(t=>({id:t.id,limit_value:t.pivot?.limit_value??(t.type==="boolean"?0:""),active:t.pivot?.active??!0}))||[]}),k=t=>{t.preventDefault(),b(route("admin.plans.update",d.id),{preserveScroll:!0})},N=(t,r,i,m)=>{o(a=>{let l=i;if(a.features.some(n=>n.id===t))return{...a,features:a.features.map(n=>n.id===t?{...n,[r]:l}:n)};{const n={id:t,limit_value:"",active:!0};return n[r]=l,{...a,features:[...a.features,n]}}})},_=(t,r)=>{o(i=>{const m=u.filter(l=>l.key.startsWith(t));let a=[...i.features];return m.forEach(l=>{const p=a.findIndex(n=>n.id===l.id);p>=0?a[p]={...a[p],active:r}:a.push({id:l.id,limit_value:l.type==="boolean"?0:"",active:r})}),{...i,features:a}})},u=x.map(t=>{const r=d.features.find(i=>i.id===t.id);return{...t,limit_value:r?.pivot?.limit_value??(t.type==="boolean"?0:null),active:r?.pivot?.active??!1}}),w={email_agent:{title:"📧 Email Agent",key:"email_agent",features:u.filter(t=>t.key.startsWith("email_agent"))},email_smart_answer:{title:"🤖 Email Smart Answer",key:"email_smart_answer",features:u.filter(t=>t.key.startsWith("email_smart_answer"))},reports:{title:"📊 Reports Agent",key:"reports",features:u.filter(t=>t.key.startsWith("reports"))},hr:{title:"👨‍💼 HR Agent",key:"hr",features:u.filter(t=>t.key.startsWith("hr"))}},f=t=>u.filter(i=>i.key.startsWith(t)).every(i=>c.features.find(a=>a.id===i.id)?.active??i.active);return e.jsxs(I,{children:[e.jsx(E,{title:`${s("edit_plan")} - ${d.name_value}`}),e.jsx("div",{className:"m-3 xl:m-5",children:e.jsx("div",{className:"overflow-hidden rounded-2xl shadow-lg dark:bg-neutral-900 border border-neutral-300 dark:border-neutral-700",children:e.jsxs("div",{className:"p-6 text-neutral-900 dark:text-neutral-100",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(j,{href:route("admin.plans.index"),className:"flex items-center text-neutral-600 hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-neutral-100 transition-colors",children:[e.jsx("i",{className:"fa-solid fa-arrow-left rtl:rotate-180 mx-2"}),s("plans")]}),e.jsx("span",{className:"text-neutral-400 dark:text-neutral-600",children:"/"}),e.jsxs("h1",{className:"text-2xl font-bold leading-tight text-neutral-900 dark:text-neutral-100",children:[e.jsx("i",{className:"fa-solid fa-edit text-blue-500 mx-2"}),s("edit_plan")," - ",d.name_value]})]})}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx(C,{htmlFor:"price",value:s("plan_price")}),e.jsx(y,{id:"price",type:"number",name:"price",value:c.price,className:"mt-1 block w-1/2",onChange:t=>o("price",t.target.value),step:"0.01",min:"0",required:!0}),e.jsx(A,{message:g.price,className:"mt-2"})]})}),e.jsx("div",{className:"mt-8 space-y-10",children:Object.values(w).map(t=>t.features.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold flex items-center",children:t.title}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:f(t.key)?s("active"):s("inactive")}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:f(t.key),onChange:r=>_(t.key,r.target.checked)}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border border-neutral-300 dark:border-neutral-700 rounded-lg",children:[e.jsx("thead",{className:"bg-neutral-100 dark:bg-neutral-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 w-1/2 py-2 rtl:text-right ltr:text-left",children:s("feature")}),e.jsx("th",{className:"px-4 w-1/2 py-2 rtl:text-right ltr:text-left",children:s("limit_value")})]})}),e.jsx("tbody",{children:t.features.map((r,i)=>{const m=c.features.find(l=>l.id===r.id);c.features.findIndex(l=>l.id===r.id),m?.active??r.active;const a=f(t.key);return e.jsxs("tr",{className:`border-t border-neutral-200 dark:border-neutral-700 ${a?"":"opacity-50"}`,children:[e.jsxs("td",{className:"px-4 py-2 font-medium relative group cursor-help",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{children:r.name_value})}),e.jsx("div",{className:"absolute z-10 hidden group-hover:block bg-blue-500 text-white text-xs rounded px-2 py-1 w-90 top-1 ltr:right-0 rtl:left-0",children:r.description_value})]}),e.jsx("td",{className:"px-4 py-2",children:r.type==="boolean"?e.jsx("div",{className:"flex items-center gap-2"}):e.jsx(y,{type:"number",value:m?.limit_value??"",onChange:l=>N(r.id,"limit_value",l.target.value),className:"w-24",min:"0",disabled:!a,placeholder:a?"0":"Disabled"})})]},r.id)})})]})})]},t.title))}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t border-neutral-200 dark:border-neutral-700",children:[e.jsx(W,{icon:"fa-times",as:j,href:route("admin.plans.index"),children:s("cancel")}),e.jsx(R,{icon:"fa-save",type:"submit",disabled:v,children:s(v?"updating":"save_changes")})]})]})]})})})]})}export{J as default};
